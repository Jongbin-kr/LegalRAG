## 1. Datasets profile
1. `dataset.csv`: 처음 크롤링 작업 후 받은 원본 데이터셋
    - `test_data.csv`, `val_data.csv`, `train_data.csv`는 원본 데이터셋을 셔플해서(random_state=42) 2:2:8 = 166:164:494 비율로 나눈 것.
2. `test_data_with_query.csv`: `test_data.csv`에 `query-make.ipynb`를 활용해 GPT가 생성한 자연어 쿼리를 추가한 것.
3. `test_data_with_retrieve.csv`: `test_data_with_query.csv` 파일을 활용해 자연어 쿼리에 대하여 BM25 리트리버로 검색한 결과 데이터셋
    - `normalize`는 DB를 제 1 정규화해서, 하나의 데이터 샘플 당 하나의 검색 결과가 매치되도록 한 것.
4. `laws_raw.csv`: 법령 정보 최종 정리본으로 전달받은 원본 파일
    - `laws_shuffled.csv`: 법령 정보 파일을 원본 데이터셋을 셔플했던 것과 같은 순서로 섞고, N/A값들을 지운 것. (원본 인덱스값은 보존되어 있음. 즉, 중간에 NA값에 해당하는 인덱스가 누락되어 있음)
5. `test_data_with_retrieve_and_laws_normalized.csv`: 최종적으로 다 정리한 파일.
 
<br>

## 2. Retriever
- BM25 알고리즘으로 retrieve
    - 이때, 검색 후보군이 되는 문서 집합은 `train_data.csv`이며, 검색의 기준이 되는 쿼리는 `test_data_with_query.csv`의 자연어 쿼리
- 검색결과를 retriever 인스턴스 내부에 저장해두고, 이후 `get_search_history()` 메소드로 확인하거나, `save_search_history_to_csv()` 메소드를 활용해 저장가능

<br>

## 3. Query maker

#### GPT-API details
- model: `gpt-3.5-turbo`
- prompt
    ```txt
    당신은 복잡한 범죄 사실들을 마치 일반인이 얘기하듯 자연스러운 문장으로 풀어쓰는 한국어 챗봇입니다.
    제가 범죄사실을 말하면, 당신은 실제 변호사에게 물어보듯 해당 범죄사실을 자연스러운 문장으로 풀어쓰세요. 
    이때 다음과 같은 규칙들을 반드시 준수해야합니다.
    1. 당신이 범죄 사실을 풀어쓸 때 담당할 역할을 피의자, 피해자, 혹은 그 주변인물 중 무작위로 정하세요.
    2. 다음의 범죄 사실에을 법률 전문가가 아닌 일반인이 물어보듯 자연스럽게 다시 풀어쓰세요.
    3. 이때, 500자 이내로 서술하세요. 그리고 매번 범죄사실이 주어질 때 마다 다른 사람이 질문하듯 감정, 역할, 말투, 법률 지식 수준 등을 바꿔주세요.
    4. 마지막에는 실제로 당신이 담당한 역할을 맡은 사람(피의자, 피해자, 혹은 그 주변인물)이 변호사에게 해당 범죄의 경우 어떤 법령에 의해서 처벌을 받는지 법률상담을 요청하는 다양한 질문들을 덧붙여주세요. 
    5. 1인칭으로 대답하세요.

    범죄 사실은 다음과 같습니다:
    {crime_facts}
    ```


#### output examples
- idx = 15
```txt
피고인은 (차량번호 생략) 포터Ⅱ 화물차를 운전하는 업무에 종사하는 사람이다.
피고인은 2021. 3. 31. 21:30경 위 화물차를 운전하여 울산 중구 B 앞 도로를 C아파트 방면에서 D아파트 방면으로 진행하였다.
당시는 야간이고 피해자 E 운전의 (차량번호 생략) 엑센트 승용차가 피고인의 위 화물차와 교행 중이었으므로 자동차를 운전하는 업무에 종사하는 사람에게는 속도를 줄이고 조향 및 제동장치를 제대로 조작하여 안전하게 운전하여야 할 업무상 주의의무가  있었다.
그럼에도 불구하고 피고인은 이를 게을리한 채 그대로 진행한 과실로 피고인 운전의 위 화물차 좌측 뒤 부분으로 위 피해자 운전의 엑센트 승용차 좌측 뒤 부분을 들이받았다.
이로써 피고인은 위와 같은 업무상 과실로 피해자에게 약 2주간의 치료가 필요한 열린 두 개 내 상처가 없는 진탕의 상해를 입게 함과 동시에 위 엑센트 승용차를 약 572,916원의 수리비가 들 정도로 손괴하였음에도 즉시 정차하여 피해자를 구호하는 등의 필요한 조치를 취하지 아니하고 그대로 도주하였다.


1. 범죄사실에 대한 해당법조
특정범죄가중처벌등에관한법률  제5조의3  제1항  제2호,  형법  제268조(도주치상의  점), 도로교통법 제148조, 제54조 제1항(사고 후 미조치의 점)
1. 상상적 경합
형법 제40조, 제50조[특정범죄가중처벌등에관한법률위반(도주치상)죄에 정한 형으로 처벌]
1. 형의 선택
징역형 선택
1. 작량감경


저는 현재 피고인입니다. 내 3월 31일 밤 9시 30분경 울산 중구 B 앞 도로를 운전 중이었습니다. 그때 피해자 E 운전의 엑센트 승용차와 교행 중이었는데, 업무상 주의 의무를 내게 주었으므로 속도를 줄이고 안전운전을 해야 했어요. 그런데 내가 안전조치를 취하지 않고, 그대로 진행하다가 엑센트 승용차를 들이받아 손해를 입히게 되었어요. 이 사고로 피해자는 상해를 입고 약 2주동안 치료를 받아야 했고, 엑센트 승용차도 수리비가 많이 들 정도로 손상을 입었어요. 하지만 나는 곧바로 정차하거나 구호 조치를 하지 않고 도주했습니다. 

저는 변호사에게, 이 범죄 행위에 대해 어떠한 형사책임이 있을까요? 그리고 관련하여 어떠한 법률적인 처벌을 받을 수 있는지 궁금합니다. 또한, 제가 이 사고로 인한 손해를 배상해야 할 의무가 있는지도 알고 싶습니다.
```


- idx = 59
```txt
피고인은 2019. 8. 4. 17:35경 B 팰리세이드 승용차를 운전하여 서울 서초구 잠원로 221-124에 있는 올림픽대로 편도 4차로 도로의 1차로 도로를 진행하던 중 위 승용차를 정차한 채 수면을 하였다.

피고인은 같은 날 18:25경 '차량이 가드레일을 박고 그냥 서있다'는 내용의 112신고를 받고 출동한 서울서초경찰서 소속 경장 C, 순경 D으로부터 말을 더듬거리고 비틀거리며 얼굴이 약간 홍조를 띄면서 입에서 술 냄새가 약간 나는 등 음주운전을 하였다고 의심할 만한 상당한 이유가 있어 3회에 걸쳐 음주측정기에 입김을 불어넣는 방법으로 음주측정에 응할 것을 요구받았다.

그럼에도 피고인은 음주측정기에 입을 대고 부는 시늉만 하는 방법으로 이를 회피하여 정당한 사유 없이 경찰공무원의 음주측정요구에 응하지 아니하여 2회 이상 도로교통법 제44조 제1항, 제2항을 위반하였다.


1. 범죄사실에 대한 해당법조 및 형의 선택

도로교통법 제148조의2 제1항, 제44조 제2항(반복 음주측정거부의 점), 징역형 선택 1. 누범가중

형법 제35조

1. 작량감경

형법 제53조, 제55조 제1항 제3호


저는 피해자 역할을 맡았습니다.

어떤 사람이 B 팰리세이드 승용차를 운전하던 중, 서울 서초구 잠원로 221-124에 위치한 올림픽대로 편도 4차로 도로의 1차로에서 차를 정차하고 수면을 취했어요. 이후 같은 날에 경찰관들이 '차량이 가드레일을 박고 그냥 서있다'는 신고를 받아 출동했고, 피고인이 음주측정에 응하지 않아 음주운전을 의심하게 되었어요. 경찰관들이 3회에 걸쳐 음주측정기로 측정을 시도했지만, 피고인은 입을 갖다대는 듯한 행동만 하고 실제로 측정에 응하지 않았죠.

그렇게 피고인은 도로교통법 제44조 제1항, 제2항을 위반하며 음주운전을 하고 음주측정에 응하지 않았습니다. 이에 대해 변호사님, 이러한 행위들이 어떻게 처벌될 수 있는지 궁금합니다. 법률상담 부탁드립니다.
```

- idx = 150
```txt
1. 도로교통법위반(음주운전)
피고인은 2018. 11. 20. 23:20경 전주시 완산구 C에 있는 D대학 앞 도로 부근에서 혈중알콜농도 0.123%의 술에 취한 상태로 E 모닝 승용차를 운전하였다.
이로써 피고인은 술에 취한 상태에서 자동차를 운전하여서는 아니 됨에도 이를 2회 이상 위반한 사람으로서 다시 술에 취한 상태로 자동차를 운전하였다.
1.  특정범죄가중처벌등에관한법률위반(도주치상),  도로교통법위반(사고후미조치),  도로교통법위반
피고인은 위 모닝 승용차 운전업무에 종사하는 사람이다.
피고인은 제1항 기재 일시경 위와 같이 술에 취한 상태로 승용차를 운전하여 위 D대학 앞 편도 2차로에서 주차된 피고인의 차량을 주행차로에 진입시키기 위해  2차로에서 1차로로 차선을 변경하게 되었다.
그곳은 편도 2차선의 도로로 1차로에 주행하는 차량이 있으므로 이러한 경우 자동차운전업무에 종사하는 사람에게는 후방을 잘 살피고 미리 방향지시등을 작동하여 다른 차량들에게 진로변경을 미리 알리며 조향 및 제동장치를 정확하게 조작하여 사고를 미연에 방지하여야 할 업무상의 주의의무가 있었다.
그럼에도 불구하고 피고인은 이를 게을리한 채 만연히 차선을 변경하다가 마침 피고인의 진행방향 1차선에서 직진하던 피해자 F(66세) 운전의 G 아우디 Q5 승용차 조수석 앞 범퍼부분을 피고인의 차량 운전석 앞 범퍼부분으로 충격하였다.
결국 피고인은 위와 같은 업무상 과실로 피해자에게 약 2주간의 치료가 필요한 경추염좌 등의 상해를 입게 함과 동시에 앞 범퍼 교환 등 수리비 9,878,110원 상당이 들도록 피해 차량을 손괴하고도 피해자를 구호하는 등 필요한 조치를 취하지 아니하고 그대로 도주하였다.


1. 범죄사실에 대한 해당법조 및 형의 선택
특정범죄 가중처벌 등에 관한 법률 제5조의3 제1항 제2호, 형법 제268조(업무상과실치상 후 도주의 점), 구 도로교통법(2018. 12. 24. 법률 제16037호로 개정되기 전의 것) 제148조의2 제1항 제1호, 제44조 제1항(음주운전의 점), 도로교통법 제151조(과실재물손괴의 점), 도로교통법 제148조, 제54조 제1항(손괴 후 미조치의 점)
1. 상상적 경합
형법 제40조, 제50조
1. 경합범가중
형법  제37조 전단, 제38조 제1항 제2호, 제50조[형이 가장 무거운 특정범죄가중처벌등에관한법률위반(도주치상)죄에 정한 형에 위 각 죄의 장기형을 합산한 범위 내에서 경합범가중]


저기요, 예전에 일어난 일로 말할게요. 어느 날 밤, 전주시 완산구에 있는 한 대학 근처 도로에서 일이 있었어요. 약속 시간이었던 밤 11시 20분쯤 되던 시간에, 혈중알콜농도가 0.123%로 술에 취한 상태인 분이라는 피고인이 E 모닝 승용차를 운전했어요. 요즘은 술에 취한 채로 차를 몰면 안 된다는 법이 있잖아요. 근데 피고인씨는 이미 두 번 이상 그 법을 어겼다가 술에 취한 채로 또 차를 몰아버렸어요.
또 하나의 사건도 있었어요. 이번에는 다른 법을 어긴 일이었어요. 피고인씨는 승용차 운전업무를 하는 일을 했지만, 승용차를 몰면서 사고를 낸 후에 책임을 회피했어요. 차선 변경할 때 주의를 기울여야 하는데, 그런 주의를 하지 않고 만연하게 차선을 변경해서 피해를 입히게 됐어요. 피해자는 경추염좌 등의 상해를 입고 치료를 받아야 했고, 차량도 수리비를 9,878,110원을 들여야 했어요. 그런데 피고인씨는 이런 상황에서 피해자를 구호하지 않고 도주했습니다. 이렇게 피해를 입히고 상대를 도망가는 행동을 한 것이죠.

저, 피의자입니다. 변호사님, 이런 경우 도로교통법 위반과 특정범죄가중처벌등에 관한 법률 위반이 저게 어떤 형사 처벌을 받게 되나요? 법률적인 대처 방안을 알려주시면 감사하겠습니다.

```